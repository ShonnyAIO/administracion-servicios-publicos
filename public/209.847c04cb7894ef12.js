"use strict";(self.webpackChunkkomerzio_front=self.webpackChunkkomerzio_front||[]).push([[209],{8209:(D,d,i)=>{i.r(d),i.d(d,{LoginModule:()=>Y});var m=i(9808),u=i(4065),g=i(6696),e=i(5e3),c=i(50),s=i(3075),f=i(8468),v=i(8113),h=i(908),p=i(7322),_=i(7531),F=i(7423);function Z(n,t){1&n&&(e.TgZ(0,"p"),e._uU(1," requerido "),e.qZA())}function x(n,t){if(1&n&&(e.TgZ(0,"div",11),e.YNc(1,Z,2,0,"p",12),e.qZA()),2&n){const o=e.oxw(2);e.ekj("error",(null==o.empresaField?null:o.empresaField.touched)&&(null==o.empresaField?null:o.empresaField.invalid)),e.xp6(1),e.Q6J("ngIf",(null==o.empresaField?null:o.empresaField.touched)&&(null==o.empresaField?null:o.empresaField.hasError("required")))}}function A(n,t){if(1&n){const o=e.EpF();e.TgZ(0,"div",5),e.TgZ(1,"form",6),e.NdJ("ngSubmit",function(){return e.CHM(o),e.oxw().validateNameEmpresa()}),e.TgZ(2,"mat-form-field",7),e.TgZ(3,"mat-label"),e._uU(4,"Empresa"),e.qZA(),e._UZ(5,"input",8),e.qZA(),e.YNc(6,x,2,3,"div",9),e.TgZ(7,"button",10),e._uU(8,"Ir a login"),e.qZA(),e.qZA(),e.qZA()}if(2&n){const o=e.oxw();e.xp6(1),e.Q6J("formGroup",o.formEmpresa),e.xp6(5),e.Q6J("ngIf",(null==o.empresaField?null:o.empresaField.touched)&&(null==o.empresaField?null:o.empresaField.invalid)),e.xp6(1),e.Q6J("disabled",null==o.empresaField?null:o.empresaField.invalid)}}function T(n,t){1&n&&(e.TgZ(0,"p"),e._uU(1," requerido "),e.qZA())}function C(n,t){1&n&&(e.TgZ(0,"p"),e._uU(1," No tiene formato de correo electronico "),e.qZA())}function b(n,t){if(1&n&&(e.TgZ(0,"div",11),e.YNc(1,T,2,0,"p",12),e.YNc(2,C,2,0,"p",12),e.qZA()),2&n){const o=e.oxw(2);e.ekj("error",(null==o.emailField?null:o.emailField.touched)&&(null==o.emailField?null:o.emailField.invalid)),e.xp6(1),e.Q6J("ngIf",(null==o.emailField?null:o.emailField.touched)&&(null==o.emailField?null:o.emailField.hasError("required"))),e.xp6(1),e.Q6J("ngIf",(null==o.emailField?null:o.emailField.touched)&&(null==o.emailField?null:o.emailField.hasError("email")))}}function I(n,t){1&n&&(e.TgZ(0,"p"),e._uU(1," requerido "),e.qZA())}function L(n,t){if(1&n&&(e.TgZ(0,"div",11),e.YNc(1,I,2,0,"p",12),e.qZA()),2&n){const o=e.oxw(2);e.ekj("error",(null==o.passwField?null:o.passwField.touched)&&(null==o.passwField?null:o.passwField.invalid)),e.xp6(1),e.Q6J("ngIf",(null==o.passwField?null:o.passwField.touched)&&(null==o.passwField?null:o.passwField.hasError("required")))}}function w(n,t){if(1&n){const o=e.EpF();e.TgZ(0,"div",5),e.TgZ(1,"form",6),e.NdJ("ngSubmit",function(){return e.CHM(o),e.oxw().loginAgente()}),e.TgZ(2,"mat-form-field",7),e.TgZ(3,"mat-label"),e._uU(4,"Email"),e.qZA(),e._UZ(5,"input",13),e.qZA(),e.YNc(6,b,3,4,"div",9),e.TgZ(7,"mat-form-field",7),e.TgZ(8,"mat-label"),e._uU(9,"Contrase\xf1a"),e.qZA(),e._UZ(10,"input",14),e.qZA(),e.YNc(11,L,2,3,"div",9),e.TgZ(12,"button",15),e._uU(13,"Iniciar sesi\xf3n"),e.qZA(),e.qZA(),e.qZA()}if(2&n){const o=e.oxw();e.xp6(1),e.Q6J("formGroup",o.formLogin),e.xp6(5),e.Q6J("ngIf",(null==o.emailField?null:o.emailField.touched)&&(null==o.emailField?null:o.emailField.invalid)),e.xp6(5),e.Q6J("ngIf",(null==o.passwField?null:o.passwField.touched)&&(null==o.passwField?null:o.passwField.invalid))}}let S=(()=>{class n{constructor(o,r,l,a){this.empresaService=o,this.formBuilder=r,this.userAgenteService=l,this.router=a,this.sendBusinessData=new e.vpe,this.errorLogin=new e.vpe,this.submitted=!1,this.actionSelected=0,this.greatingText=[{welcome:"Bienvenido a komerzio.",action:"Ingresa el nombre de la empresa."},{welcome:"Bienvenido al canal de ",action:"Ingresa tus credenciales para iniciar sesi\xf3n."}],this.formEmpresa=new s.cw({}),this.formLogin=new s.cw({}),this.businessAssets={url:"",name:"",borderColor:!0},this.builderForm(),this.loginForm()}ngOnInit(){}get empresaField(){return this.formEmpresa.get("empresa")}get emailField(){return this.formLogin.get("email")}get passwField(){return this.formLogin.get("password")}validateNameEmpresa(){console.log(this.formEmpresa.value),this.formEmpresa.valid?this.empresaService.getValidateNameEmpresa(this.formEmpresa.value.empresa).subscribe(o=>{console.log(o),this.infEmpresa=o.msg,localStorage.setItem("sessionEmpresa",this.infEmpresa._id),localStorage.setItem("multiDevice",this.infEmpresa.multiDevice),this.loginAgenteEmpresa(o.msg)},o=>{console.log(o),this.errorLogin.emit(o)}):this.formLogin.markAllAsTouched()}builderForm(){this.formEmpresa=this.formBuilder.group({empresa:["",s.kI.required]})}loginForm(){this.formLogin=this.formBuilder.group({email:["",[s.kI.required,s.kI.email]],password:["",[s.kI.required]]})}loginAgenteEmpresa(o){this.submitted=!0,this.actionSelected=1,this.businessAssets.url="https://tennisshop.store/wp-content/uploads/2021/02/Logo-TS-160.png",this.businessAssets.name="A1win",this.businessAssets.borderColor=!0,this.sendBusinessData.emit(this.businessAssets),this.greatingText[this.actionSelected].welcome="Bienvenido al canal de "+o.nombre_empresa}loginAgente(){console.log(this.formLogin.value),this.formLogin.valid?this.userAgenteService.loginAgent(this.infEmpresa._id,this.formLogin.value).subscribe(o=>{localStorage.setItem("session",o.msg),localStorage.setItem("sessionWA",o.sessionWA),this.router.navigate(["/live-conversation"])},o=>{console.error(o),this.errorLogin.emit(o)}):this.formLogin.markAllAsTouched()}}return n.\u0275fac=function(o){return new(o||n)(e.Y36(f.P),e.Y36(s.qu),e.Y36(v.d),e.Y36(g.F0))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-form-login"]],outputs:{sendBusinessData:"sendBusinessData",errorLogin:"errorLogin"},decls:12,vars:4,consts:[[1,"row","center-xs"],[1,"col-12"],[1,"text-primary"],["class","col-xs-10 col-sm-8 col-md-8 col-lg-8",4,"ngIf","ngIfElse"],["login",""],[1,"col-xs-10","col-sm-8","col-md-8","col-lg-8"],[3,"formGroup","ngSubmit"],["appearance","fill",1,"komerzio-full-width"],["formControlName","empresa","matInput",""],["class","alert",3,"error",4,"ngIf"],["type","submit","mat-flat-button","",1,"submit",3,"disabled"],[1,"alert"],[4,"ngIf"],["formControlName","email","matInput",""],["formControlName","password","type","password","matInput",""],["mat-flat-button","",1,"submit"]],template:function(o,r){if(1&o&&(e.TgZ(0,"div",0),e.TgZ(1,"div",1),e.TgZ(2,"p",2),e._uU(3),e._UZ(4,"br"),e.TgZ(5,"strong"),e._uU(6),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e.TgZ(7,"div",0),e.YNc(8,A,9,3,"div",3),e.YNc(9,w,14,3,"ng-template",null,4,e.W1O),e.qZA(),e._UZ(11,"app-tool-box-login")),2&o){const l=e.MAs(10);e.xp6(3),e.hij("Hola, ",r.greatingText[r.actionSelected].welcome,""),e.xp6(3),e.Oqu(r.greatingText[r.actionSelected].action),e.xp6(2),e.Q6J("ngIf",!r.submitted)("ngIfElse",l)}},directives:[m.O5,h.M,s._Y,s.JL,s.sg,p.KE,p.hX,s.Fj,_.Nt,s.JJ,s.u,F.lW],styles:[".submit[_ngcontent-%COMP%]{width:100%;height:38px;background:#161D4B 0% 0% no-repeat padding-box;border-radius:10px;font: 12px/14px Roboto;letter-spacing:0px;color:#fff;opacity:1}.komerzio-full-width[_ngcontent-%COMP%]{width:100%;font-size:12px}.valid[_ngcontent-%COMP%]{border-color:#161d4b}.alert[_ngcontent-%COMP%]{opacity:1;transition:all .5s ease-in;color:red;text-align:left;margin-top:-4%;margin-left:4%;font-size:10px}.alert[_ngcontent-%COMP%]   .error[_ngcontent-%COMP%]{opacity:1}.input-komerzio[_ngcontent-%COMP%]{background:#F5F5F5 0% 0% no-repeat padding-box;border-radius:10px;opacity:1}.mat-form-field-flex[_ngcontent-%COMP%]{border:1px solid red}"]}),n})();var q=i(547),E=i(833),M=i(2329);function J(n,t){if(1&n&&(e.TgZ(0,"div"),e.TgZ(1,"div",9),e._UZ(2,"app-error-advice",10),e.qZA(),e.qZA()),2&n){const o=e.oxw();e.xp6(2),e.Q6J("message",o.error_message)}}function N(n,t){if(1&n&&e._UZ(0,"app-banner-login",11),2&n){const o=e.oxw();e.Q6J("assets",o.assetsDecorator)}}const y=[{path:"",component:(()=>{class n{constructor(){this.error_message={msg:"",type:""},localStorage.removeItem("session"),localStorage.removeItem("sessionWA"),this.assetsDecorator={url:"https://firebasestorage.googleapis.com/v0/b/kenzi-dev-version.appspot.com/o/assets%2Fimages%2Flogin-banner.png?alt=media&token=419d8c17-31c6-435a-be7c-582482fbf434",name:"Komerzio",borderColor:!1}}ngOnInit(){}errorLogin(o){console.log("error event: ",o.error.msg),this.error_message.msg=o.error.msg,this.error_message.type="error",setTimeout(()=>{this.error_message={}},2e3)}getBusinessDataFromLogin(o){this.assetsDecorator=o}}return n.\u0275fac=function(o){return new(o||n)},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-sign-in"]],decls:13,vars:2,consts:[[1,"container-fluid"],[1,"row"],[1,"col-md-12",2,"margin-bottom","-6%"],[4,"ngIf"],[1,"col-md-6"],[1,"container-login"],[3,"sendBusinessData","errorLogin"],[1,"col-md-6","col-xs-12"],[3,"assets",4,"ngIf"],[1,"row","center-xs"],[3,"message"],[3,"assets"]],template:function(o,r){1&o&&(e._UZ(0,"app-header"),e.TgZ(1,"div",0),e.TgZ(2,"div",1),e.TgZ(3,"div",2),e.YNc(4,J,3,1,"div",3),e.qZA(),e.qZA(),e.TgZ(5,"div",1),e.TgZ(6,"div",4),e.TgZ(7,"div",5),e.TgZ(8,"app-form-login",6),e.NdJ("sendBusinessData",function(a){return r.getBusinessDataFromLogin(a)})("errorLogin",function(a){return r.errorLogin(a)}),e.qZA(),e.qZA(),e.qZA(),e.TgZ(9,"div",7),e.TgZ(10,"div",5),e.YNc(11,N,1,1,"app-banner-login",8),e.qZA(),e.qZA(),e.qZA(),e.qZA(),e._UZ(12,"app-footer")),2&o&&(e.xp6(4),e.Q6J("ngIf",r.error_message.msg),e.xp6(7),e.Q6J("ngIf",r.assetsDecorator))},directives:[c.G,m.O5,S,q.c,E.Y,M.M],styles:[".container-login[_ngcontent-%COMP%]{top:15%;position:relative}.container-fluid[_ngcontent-%COMP%]{padding:30px 0;grid-row-gap:15px;display:grid;height:100%}.row[_ngcontent-%COMP%]{width:100%}@media (max-width: 768px){.container-fluid[_ngcontent-%COMP%]{padding-right:0;padding-left:0}}"]}),n})()}];let B=(()=>{class n{}return n.\u0275fac=function(o){return new(o||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[[g.Bz.forChild(y)],g.Bz]}),n})();var U=i(4271),O=i(3616);let Y=(()=>{class n{}return n.\u0275fac=function(o){return new(o||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[[m.ez,u.m,B,U.P,O.I]]}),n})()}}]);